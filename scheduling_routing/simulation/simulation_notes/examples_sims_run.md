# Examples Simulations Run(ed)

# Example: CBR (Constant Bit Rate) simulation 
- **Command:** `./ns3 run "contrib/satellite/examples/sat-cbr-example`
- **Expected Output:** Packet logs
- **STATUS: PASS**

## NS-3 Satellite CBR Simulation Analysis
- Date: November 16, 2025
- Simulator: ns-3 version 3.43
- Author: geemajor (joy)

## 1. Summary
This document details the execution and preliminary analysis of the `sat-cbr-example` simulation within the `ns-3.43` network simulator. The goal of this run was to generate network traffic data for a satellite communication scenario involving Constant Bit Rate (CBR) traffic and to inspect the resulting log files to understand the network events at various layers of the OSI model.

## 2. Execution (Steps)
### 2.1 Run the Simulation Command
The `sat-cbr-example` script, located within the satellite module contributions, was executed using the ns3 waf build system. The simulator first compiled the necessary C++ objects and linked the required libraries before running the scenario.
  ```
  geemajor@joy:~/ns-3.43$ ./ns3 run "contrib/satellite/examples/sat-cbr-example" 
[  0%] Building CXX object contrib/satellite/CMakeFiles/satellite.dir/model/satellite-net-device.cc.o 
[  0%] Linking CXX shared library /home/geemajor/ns-3.43/build/lib/libns3.43-satellite-optimized.so
  ```

### 2.2 Locating Generated Log Files
After the simulation completed, the `find` command was used to locate all generated log files `(.log)` within the simulation data directory. This search revealed numerous logs from various examples and test cases included in the satellite module.
  ```
# Command
geemajor@joy:~/ns-3.43$ find contrib/satellite/data/sims/ -type f -name "*.log"

# Output
contrib/satellite/data/sims/test-sat-arq/rtn/SimInfo.log
contrib/satellite/data/sims/test-sat-simple-unicast/unicast6/SimInfo.log
contrib/satellite/data/sims/example-tutorial/Simple/PacketTrace.log
contrib/satellite/data/sims/example-cbr-stats/larger/PacketTrace.log
contrib/satellite/data/sims/example-cbr/simple/PacketTrace.log
...and many more...
  ```
The command returned an extensive list of log files. Key log types generated include:
- `SimInfo.log`: Contains general information about the simulation setup.
- `SimDiff.log`: Used for regression testing to compare outputs.
- `PacketTrace.log`: Provides a detailed, event-by-event trace of individual packets moving through the network.

## 3. Log File Analysis
For this analysis, we focused on the `PacketTrace.log` generated by the `example-cbr/simple` scenario.

## 3.1 Inspecting the Log Header and Content
The head command was used to view the first 20 lines of the `PacketTrace.log` file to understand its structure.
  ```
geemajor@joy:~/ns-3.43$ head -n 20 contrib/satellite/data/sims/example-cbr/simple/PacketTrace.log
  ```
**Log Structure<br>**
The header of the log file provides a clear description of each column:

- Time: The simulation time (in seconds) when the event occurred.
- Packet event: The type of event (SND for send, RCV for receive, DRP for drop, ENQ for enqueue).
- Node type: The category of the network node (UT for User Terminal, SAT for Satellite, GW for Gateway, etc.).
- Node id: The unique identifier for the node.
- MAC address: The MAC address of the network interface.
- Log level: The OSI model layer where the event was logged (ND for Network Device, LLC, MAC, PHY for Physical, CH for Channel).
- Link direction: The direction of data flow (FWD for forward, RTN for return).
- Packet info: Details about the packet, including its ID and source/destination MAC addresses.

**Output**<br>
  ```
COLUMN DESCRIPTIONS
-------------------
Time
Packet event (SND, RCV, DRP, ENQ)
Node type (UT, SAT, GW, NCC, TER)
Node id
MAC address
Log level (ND, LLC, MAC, PHY, CH)
Link direction (FWD, RTN)
Packet info (List of: Packet id, source MAC address, destination MAC address)
-------------------

0.05 SND GW 2 00:00:00:00:00:04 ND FWD 0
0.05 ENQ GW 2 00:00:00:00:00:04 LLC FWD 0 00:00:00:00:00:04 ff:ff:ff:ff:ff:ff
0.0500152 SND GW 2 00:00:00:00:00:04 LLC FWD 0 00:00:00:00:00:04 ff:ff:ff:ff:ff:ff
0.0500152 SND GW 2 00:00:00:00:00:04 MAC FWD 0 00:00:00:00:00:04 ff:ff:ff:ff:ff:ff
0.0500152 SND GW 2 00:00:00:00:00:04 PHY FWD 0 00:00:00:00:00:04 ff:ff:ff:ff:ff:ff
0.1 SND GW 2 00:00:00:00:00:04 ND FWD 1
0.1 ENQ GW 2 00:00:00:00:00:04 LLC FWD 1 00:00:00:00:00:04 ff:ff:ff:ff:ff:ff
0.1 SND GW 2 00:00:00:00:00:04 LLC FWD 1 00:00:00:00:00:04 ff:ff:ff:ff:ff:ff
  ```

## 3.2 Filtering for Physical Layer (PHY) Events
To focus on the transmission and reception of signals, the log was filtered using `grep` to show only events occurring at the PHY layer.
  ```
geemajor@joy:~/ns-3.43$ grep "PHY" contrib/satellite/data/sims/example-cbr/simple/PacketTrace.log | head
  ```
**Filtered Output**<br> This output shows packets being sent `(SND)` by the Gateway (GW) and subsequently received `(RCV)` and resent by the Satellite (SAT).
  ```
Log level (ND, LLC, MAC, PHY, CH)
0.0500152 SND GW 2 00:00:00:00:00:04 PHY FWD 0 00:00:00:00:00:04 ff:ff:ff:ff:ff:ff
0.100008 SND GW 2 00:00:00:00:00:04 PHY FWD 1 00:00:00:00:00:04 ff:ff:ff:ff:ff:ff
0.15 SND GW 2 00:00:00:00:00:04 PHY FWD 2 00:00:00:00:00:04 ff:ff:ff:ff:ff:ff
0.183623 RCV SAT 0 00:00:00:00:00:01 PHY FWD 0 00:00:00:00:00:04 ff:ff:ff:ff:ff:ff
0.183623 SND SAT 0 00:00:00:00:00:01 PHY FWD 0 00:00:00:00:00:04 ff:ff:ff:ff:ff:ff
0.200024 SND GW 2 00:00:00:00:00:04 PHY FWD 3 00:00:00:00:00:04 ff:ff:ff:ff:ff:ff
0.233616 RCV SAT 0 00:00:00:00:00:01 PHY FWD 1 00:00:00:00:00:04 ff:ff:ff:ff:ff:ff
0.233616 SND SAT 0 00:00:00:00:00:01 PHY FWD 1 00:00:00:00:00:04 ff:ff:ff:ff:ff:ff
0.250017 SND GW 2 00:00:00:00:00:04 PHY FWD 4 00:00:00:00:00:04 ff:ff:ff:ff:ff:ff
  ```
**Observation:** 
- Propagation Delay: The time delay between the GW sending a packet (e.g., packet 0 at `0.0500152s`) and the SAT receiving it (at 0.`183623s`) represents the propagation delay for the uplink. We can calculate this propagation delay (τ 
prop
​
 ) as follows:

$$ \tau_{prop} = T_{RCV}(SAT) - T_{SND}(GW) $$
$$ \tau_{prop} = 0.183623s - 0.0500152s \approx 0.1336 \text{ seconds } (133.6 \text{ ms}) $$

This value is typical for the Gateway-to-Satellite hop in a Geostationary Earth Orbit (GEO) simulation setup.

- Packet Interval: The Gateway (GW, Node 2) sends packets at a consistent interval of approximately 0.05 seconds (50 ms). This confirms the Constant Bit Rate (CBR) nature of the traffic generator in the simulation.
- Satellite Turnaround Time: The satellite (SAT, Node 0) retransmits packets at the exact same simulation timestamp as it receives them (e.g., RCV and SND for packet 0 both occur at `0.183623s`). This indicates the model is using a simple "bent-pipe" transponder model with zero processing delay.
- Broadcast Traffic: The destination MAC address for all packets is `ff:ff:ff:ff:ff:ff`, which is the broadcast address. This implies the Gateway is broadcasting the CBR stream to all terminals in the satellite's footprint.
